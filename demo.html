<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="line_intersection.js : A JavaScript library to find the intersection of two straight lines (useful for charting libraries)" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>line_intersection.js</title>
    <script src="javascripts/line_intersection_v0.1.js"></script>
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="javascripts/highcharts_v3.0.5.js"></script>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/vigneshwaranr/line_intersection.js">View on GitHub</a>

          <h1 id="project_title"><a href="http://vigneshwaranr.github.io/line_intersection.js/">line_intersection.js</a></h1>
          <h2 id="project_tagline">A JavaScript library to find the intersection of two straight lines (useful for charting libraries)</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/vigneshwaranr/line_intersection.js/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/vigneshwaranr/line_intersection.js/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>Forecast Demo</h1>
<!-- Start copy from index.html -->
<p><strong>Source</strong></p>

<div class="highlight highlight-javascript"><pre><span class="nx">jQuery</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">data1</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="nb">Date</span><span class="p">.</span><span class="nx">UTC</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">50</span><span class="p">],</span>
        <span class="p">[</span><span class="nb">Date</span><span class="p">.</span><span class="nx">UTC</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">58</span><span class="p">],</span>
        <span class="p">[</span><span class="nb">Date</span><span class="p">.</span><span class="nx">UTC</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">58</span><span class="p">],</span>
        <span class="p">[</span><span class="nb">Date</span><span class="p">.</span><span class="nx">UTC</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">58</span><span class="p">]</span>
    <span class="p">];</span>
    <span class="kd">var</span> <span class="nx">data2</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="nb">Date</span><span class="p">.</span><span class="nx">UTC</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="nb">Date</span><span class="p">.</span><span class="nx">UTC</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">12</span><span class="p">],</span>
        <span class="p">[</span><span class="nb">Date</span><span class="p">.</span><span class="nx">UTC</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">18</span><span class="p">],</span>
        <span class="p">[</span><span class="nb">Date</span><span class="p">.</span><span class="nx">UTC</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">22</span><span class="p">]</span>
    <span class="p">];</span>
    <span class="kd">var</span> <span class="nx">data1_t</span> <span class="o">=</span> <span class="nx">getTrendlineData</span><span class="p">(</span><span class="nx">data1</span><span class="p">).</span><span class="nx">data</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">data2_t</span> <span class="o">=</span> <span class="nx">getTrendlineData</span><span class="p">(</span><span class="nx">data2</span><span class="p">).</span><span class="nx">data</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">icptPoint</span><span class="o">:</span> <span class="p">{</span>
            <span class="c1">//name: 'Possible release date',</span>
            <span class="nx">marker</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">enabled</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="nx">fillColor</span><span class="o">:</span> <span class="s1">'#003300'</span><span class="p">,</span>
                <span class="nx">lineColor</span><span class="o">:</span> <span class="s1">'#003300'</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">validateIntersection</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">icptX</span><span class="p">,</span> <span class="nx">icptY</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Don't connect the lines if the intersection point is</span>
            <span class="c1">// to the left of the chart</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">icptX</span> <span class="o">&lt;</span> <span class="nx">data1_t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="nx">icptX</span> <span class="o">&lt;</span> <span class="nx">data2_t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">forecast</span> <span class="o">=</span> <span class="nx">getLineIntersectionData</span><span class="p">(</span><span class="nx">data1_t</span><span class="p">,</span> <span class="nx">data2_t</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">chart_linear</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Highcharts</span><span class="p">.</span><span class="nx">Chart</span><span class="p">({</span>
        <span class="nx">chart</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">renderTo</span><span class="o">:</span> <span class="s1">'container'</span>
        <span class="p">},</span>
        <span class="nx">colors</span><span class="o">:</span> <span class="p">[</span><span class="s1">'#990000'</span><span class="p">,</span> <span class="s1">'#4679BD'</span><span class="p">,</span> <span class="s1">'#990000'</span><span class="p">,</span> <span class="s1">'#4679BD'</span><span class="p">],</span>
        <span class="nx">xAxis</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">'datetime'</span><span class="p">,</span>
            <span class="nx">gridLineWidth</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nx">gridLineDashStyle</span><span class="o">:</span> <span class="s1">'shortdot'</span>
        <span class="p">},</span>
        <span class="nx">yAxis</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">min</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">gridLineDashStyle</span><span class="o">:</span> <span class="s1">'shortdot'</span>
        <span class="p">},</span>
        <span class="nx">title</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">text</span><span class="o">:</span> <span class="s1">'Estimating release date'</span>
        <span class="p">},</span>
        <span class="nx">series</span><span class="o">:</span> <span class="p">[{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">'Total issues'</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span> <span class="nx">data1</span>
        <span class="p">},</span> <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">'Closed issues'</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span> <span class="nx">data2</span>
        <span class="p">},</span> <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">'Total issues trend'</span><span class="p">,</span>
            <span class="c1">//getLineIntersectionData() may return undefined if lines can not intersect</span>
            <span class="nx">data</span><span class="o">:</span> <span class="nx">forecast</span> <span class="o">&amp;&amp;</span> <span class="nx">forecast</span><span class="p">.</span><span class="nx">line1_data</span> <span class="o">||</span> <span class="nx">data1_t</span><span class="p">,</span>
            <span class="nx">marker</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">enabled</span><span class="o">:</span> <span class="kc">false</span>
            <span class="p">},</span>
            <span class="nx">dashStyle</span><span class="o">:</span> <span class="s1">'longDash'</span>
        <span class="p">},</span> <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">'Closed issues trend'</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span> <span class="nx">forecast</span> <span class="o">&amp;&amp;</span> <span class="nx">forecast</span><span class="p">.</span><span class="nx">line2_data</span> <span class="o">||</span> <span class="nx">data2_t</span><span class="p">,</span>
            <span class="nx">marker</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">enabled</span><span class="o">:</span> <span class="kc">false</span>
            <span class="p">},</span>
            <span class="nx">dashStyle</span><span class="o">:</span> <span class="s1">'longDash'</span><span class="p">,</span>
        <span class="p">}]</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<p>Output:</p>

<p><img src="https://raw.github.com/vigneshwaranr/line_intersection.js/master/screenshots/trend_forecast.png" alt="Trend forecast"></p>
<!-- End copy from index.html -->

        <div id="container" style="height: 400px"></div>
        <script type="text/javascript">
            jQuery(function () {
                var data1 = [
                    [Date.UTC(2013, 0, 1), 50],
                    [Date.UTC(2013, 0, 2), 58],
                    [Date.UTC(2013, 0, 3), 58],
                    [Date.UTC(2013, 0, 4), 58]
                ];
                var data2 = [
                    [Date.UTC(2013, 0, 1), 0],
                    [Date.UTC(2013, 0, 2), 12],
                    [Date.UTC(2013, 0, 3), 18],
                    [Date.UTC(2013, 0, 4), 22]
                ];
                var data1_t = getTrendlineData(data1).data;
                var data2_t = getTrendlineData(data2).data;
                var options = {
                    icptPoint: {
                        //name: 'Possible release date',
                        marker: {
                            enabled: true,
                            fillColor: '#003300',
                            lineColor: '#003300'
                        }
                    },
                    validateIntersection: function(icptX, icptY) {
                        // Don't connect the lines if the intersection point is
                        // to the left of the chart
                        if (icptX < data1_t[0][0] || icptX < data2_t[0][0]) {
                            return false;
                        }
                    }
                };
                var forecast = getLineIntersectionData(data1_t, data2_t, options);
            
                var chart_linear = new Highcharts.Chart({
                    chart: {
                        renderTo: 'container'
                    },
                    colors: ['#990000', '#4679BD', '#990000', '#4679BD'],
                    xAxis: {
                        type: 'datetime',
                        gridLineWidth: 1,
                        gridLineDashStyle: 'shortdot'
                    },
                    yAxis: {
                        min: 0,
                        gridLineDashStyle: 'shortdot'
                    },
                    title: {
                        text: 'Estimating release date'
                    },
                    series: [{
                        name: 'Total issues',
                        data: data1
                    }, {
                        name: 'Closed issues',
                        data: data2
                    }, {
                        name: 'Total issues trend',
                        //getLineIntersectionData() may return undefined if lines can not intersect
                        data: forecast && forecast.line1_data || data1_t,
                        marker: {
                            enabled: false
                        },
                        dashStyle: 'longDash'
                    }, {
                        name: 'Closed issues trend',
                        data: forecast && forecast.line2_data || data2_t,
                        marker: {
                            enabled: false
                        },
                        dashStyle: 'longDash',
                    }]
                });
            });
        </script>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">line_intersection.js maintained by <a href="https://github.com/vigneshwaranr">vigneshwaranr</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>
  </body>
</html>
